<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>
        阿森的Blog
    </title>
    
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.2"></head>

<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-reply replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            问题库
        </p>
        <hr>
    </div>
    <div class="post-content">
        <center><h1>学习记录</h1></center>

<h3 id="进度"><a href="#进度" class="headerlink" title="进度"></a>进度</h3><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1e5411s7dv?p=119">https://www.bilibili.com/video/BV1e5411s7dv?p=119</a></p>
<h3 id="2021-10-28"><a href="#2021-10-28" class="headerlink" title="2021-10-28"></a>2021-10-28</h3><h4 id="服务搭建集群后发生的问题："><a href="#服务搭建集群后发生的问题：" class="headerlink" title="服务搭建集群后发生的问题："></a>服务搭建集群后发生的问题：</h4><p>1.用户的请求到底要发送到哪台服务器上，如何保证请求平均的分发给不同的服务器，从而缓解用户量增加的压力</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nginx - 解决用户请求平均分发</span><br></pre></td></tr></table></figure>
<p>2.编写项目时，如果用户登陆成功了将用户的标识放到Session域中在搭建集群之后数据如何共享</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">采用Redis - 解决数据共享并实现缓存功能</span><br></pre></td></tr></table></figure>
<p>3.当数据量特别庞大时，如果还直接去数据库查询，速度很慢，如何提升查询效率</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">优化索引</span><br><span class="line">查看日志来定位慢查询</span><br><span class="line">采用Redis - 解决数据共享并实现缓存功能(例如报表等一些不常变动并且需要经常查询的数据)</span><br></pre></td></tr></table></figure>
<p>4.针对大家在搜索一些数据时，where content like ‘%[xxx]%’ 如何进行优化</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">采用ElasticSearch来顶替掉where content like &#x27;%[xxx]%&#x27;等</span><br></pre></td></tr></table></figure>
<h3 id="2021-10-30"><a href="#2021-10-30" class="headerlink" title="2021-10-30"></a>2021-10-30</h3><h4 id="docker相关："><a href="#docker相关：" class="headerlink" title="docker相关："></a>docker相关：</h4><p>1.docker命令</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker start｜stop 镜像id    <span class="comment">//启动停止</span></span><br><span class="line">docker pull｜push 镜像地址    <span class="comment">//拉取 推送</span></span><br><span class="line">docker images    <span class="comment">//查看镜像</span></span><br><span class="line">docker ps -a    <span class="comment">//查看正在运行的镜像</span></span><br><span class="line">docker rmi 镜像标识符    <span class="comment">//删除本地镜像</span></span><br><span class="line">docker save -o 导出的路径 镜像id    <span class="comment">//导出本地景象</span></span><br><span class="line">docker load -i 镜像文件    <span class="comment">//导入本地镜像</span></span><br><span class="line">docker tag 镜像id 新镜像名称：版本    <span class="comment">//修改镜像名称</span></span><br><span class="line">docker build -t runoob/ubuntu:v1    <span class="comment">//使用当前目录的 Dockerfile 创建镜像，标签为 runoob/ubuntu:v1</span></span><br><span class="line">docker build url地址    <span class="comment">//通过url地址上的Dockerfile文件</span></span><br><span class="line">docker build -f 指定路径    <span class="comment">//通过指定路径构建</span></span><br></pre></td></tr></table></figure>
<p>2.docker自定义镜像<br><img src="/img/2021/docker1.jpeg" alt="avatar"><br>3.自定义docker-compose.yml文件<br><img src="/img/2021/docker-compose-yml.png" alt="avatar"><br>4.docker-compose命令<br><img src="/img/2021/docker-compose.png" alt="avatar"><br>5.gitlab配合git-runner来实现持续化集成<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_27520051/article/details/80552220">https://blog.csdn.net/qq_27520051/article/details/80552220</a><br>6.gitlab-ci持续化脚本<br><img src="/img/2021/gitlab-ci.png" alt="avatar"><br>7.Jenkins搭建自动化部署项目<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_37372007/article/details/81586751">https://blog.csdn.net/qq_37372007/article/details/81586751</a><br>8.Nginx正反向代理<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yanzi2020/p/14434686.html">https://www.cnblogs.com/yanzi2020/p/14434686.html</a><br>9.Nginx负载均衡<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/gu_wen_jie/article/details/82149003">https://blog.csdn.net/gu_wen_jie/article/details/82149003</a><br>10.Redis中RDB和AOF的区别<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/denghonghao/article/details/82108770">https://blog.csdn.net/denghonghao/article/details/82108770</a></p>
<h3 id="2021-10-31"><a href="#2021-10-31" class="headerlink" title="2021-10-31"></a>2021-10-31</h3><h4 id="ES相关："><a href="#ES相关：" class="headerlink" title="ES相关："></a>ES相关：</h4><p>1.1 为什么要学习使用ES</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在海量数据执行搜索功能的时候，如果使用MySQL，效率太低</span><br><span class="line">输入的关键字不准确，一样可以搜索到想要的数据</span><br><span class="line">将搜索关键字，以红色字体展示</span><br></pre></td></tr></table></figure>
<p>1.2 ES介绍</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ES是一个基于Java语言并且基于Lucene编写的搜索引擎框架，他提供了分布式的全文搜索功能</span><br><span class="line">提供了统一的基于RESTful风格的WEB接口，官方客户端也对多种语言都提供了相应的API</span><br><span class="line">Lucene：本身就是一个搜索引擎的底层。就是一个开发好的第三方的jar包，ES基于Lucene开发出来的</span><br><span class="line">分布式：ES主要是为了突出他的横向扩展能力。</span><br><span class="line">全文检索：比如搜索一个关键字‘手机壳’，ES对关键字会进行分词，并且将分出来的单个词语统一的放到一个分词库中，在搜索时，根据关键字去分词库中搜索，根据分词对应的数据进行展示(找到匹配内容) -&gt; (倒排索引)</span><br><span class="line">ES和Solr的区别：https://blog.csdn.net/qq_34412985/article/details/97621382</span><br><span class="line">RESTful风格：PostMan模拟</span><br><span class="line">许多的大型网站，如一些文章检索，购物网站，搜索基本上用的都是ES</span><br></pre></td></tr></table></figure>
<p>1.3 ES安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker pull docker.elastic.co/elasticsearch/elasticsearch:7.15.1</span><br><span class="line">运行</span><br><span class="line">docker run -d -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; docker.elastic.co/elasticsearch/elasticsearch:7.15.1</span><br></pre></td></tr></table></figure>
<p>1.4 倒排索引</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">将存放的数据，以一定的方式进行分词，并且将分词的内容存放到一个单独的分词库中。</span><br><span class="line">当用户去查询数据时，会将用户查询的关键字进行分词。</span><br><span class="line">到分词库中进行检索内容，拿到数据的id标识。</span><br><span class="line">然后根据id标识去存放数据的位置获取指定的数据。</span><br></pre></td></tr></table></figure>
<p>1.5 IK分词器是ElasticSearch的插件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bin目录下elasticsearch-plugin install 插件url</span><br><span class="line">注：如果ES是在容器安装的 需要进入容器内部安装IK分词器物 装完插件需要重启ES</span><br><span class="line">// 分析过程：https://blog.csdn.net/xf_87/article/details/79402489</span><br><span class="line">POST _analyze</span><br><span class="line">&#123;</span><br><span class="line">	&quot;analyzer&quot;:&quot;ik_max_word&quot;,</span><br><span class="line">	&quot;text&quot;:&quot;窗前明月光&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1.6 ES存储结构：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ES分片：</span><br><span class="line">多台ES服务器，对索引进行分片操作，根据搜索内容的不同，选择不同的ES服务器</span><br><span class="line">可以提高搜索效率，提升数据存储容量</span><br><span class="line">而且会对索引进行备份</span><br><span class="line">ES的一个索引对应多个类型(5.X版本)</span><br><span class="line">ES5.X版本中，一个索引可以创建多个Type</span><br><span class="line">ES6.X版本中，一个索引可以创建一个Type</span><br><span class="line">ES7.X版本中，一个索引没有Type</span><br><span class="line">ES的结构：</span><br><span class="line">索引：默认被分成5片存储，每一个分片至少存在一个备份分片，备份分片默认不会帮助检索数据，当ES检索压力特别大的时候，备份分片才会帮助检索数据，备份分片必须放在不同的服务器中</span><br><span class="line">类型：一个索引可以创建多个类型(根据版本不同，类型的创建也不同)</span><br><span class="line">文档：一个类型下可以有多个文档，这个文档就类似于mysql表中的多行数据</span><br><span class="line">属性：一个文档可以包含多个属性，类似于mysql表中的一行数据对应的多个列</span><br><span class="line">服务-&gt;索引-&gt;类型-&gt;文档-&gt;属性(列)</span><br></pre></td></tr></table></figure>
<p>2.1 操作ES的RESTful语法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">GET请求：</span><br><span class="line">  http://ip:port/index(查询索引信息)</span><br><span class="line">  http://ip:port/index/type/doc_id(根据id查询指定的文档信息)</span><br><span class="line">POST请求：</span><br><span class="line">  http://ip:port/index/type/_search(查询，可以在请求体中添加json字符串来代表查询操作)</span><br><span class="line">  http://ip:port/index/type/doc_id/_update(修改文档，在请求体中指定修改的具体信息[json字符串])</span><br><span class="line">PUT请求：</span><br><span class="line">  http://ip:port/index(创建一个索引，需要在请求体中指定索引的信息)</span><br><span class="line">  http://ip:port/index/type_mappings(创建索引时，指定索引文档存储的属性信息)</span><br><span class="line">DELETE请求：</span><br><span class="line">  http://ip:port/index(删除索引)</span><br><span class="line">  http://ip:port/index/type/doc_id(删除指定的文档)</span><br><span class="line">//创建索引</span><br><span class="line">PUT /person</span><br><span class="line">&#123;</span><br><span class="line">	&quot;settings&quot;:&#123;</span><br><span class="line">		&quot;number_of_sharrds&quot;:5,    //分片数</span><br><span class="line">		&quot;number_of_replicas&quot;1     //备份数据</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">//查询索引</span><br><span class="line">PUT /person</span><br><span class="line">//删除索引</span><br><span class="line">DELETE /person</span><br></pre></td></tr></table></figure>
<p>2.2 ES中属性可以指定的类型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">字符串类型：</span><br><span class="line">String</span><br><span class="line">	keyword：当前属性(Feild)不会被分词</span><br><span class="line">	text：一般被用于全文检索。将当前Field进行分词。</span><br><span class="line">数值类型：</span><br><span class="line">	Byte:</span><br><span class="line">	Short:</span><br><span class="line">	Intager:</span><br><span class="line">	Long:</span><br><span class="line">	Float:</span><br><span class="line">	Double:</span><br><span class="line">	Half_float:精度比float小一半</span><br><span class="line">	Scaled_float:根据一个long和scaled来表达一个浮点型，long 345，scaled 100 -&gt; 3.45</span><br><span class="line">	Date:时间类型</span><br><span class="line">	Boolean:true或false</span><br><span class="line">二进制类型:</span><br><span class="line">	binary:暂时支持Base64 encode String</span><br><span class="line">范围类型：</span><br><span class="line">	long_range:赋值时，无需指定具体的内容，只需要存储一个范围即可，指定gt，lt，gte，lte</span><br><span class="line">	intager_range:...</span><br><span class="line">	float_range:...</span><br><span class="line">	double_range:...</span><br><span class="line">	date_range:...</span><br><span class="line">	ip_range:同上</span><br><span class="line">经纬度类型：</span><br><span class="line">	geo_point:用来存储经纬度的</span><br></pre></td></tr></table></figure>
<p>2.3 ES创建索引并指定数据结构</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">PUT /book</span><br><span class="line">&#123;</span><br><span class="line">	&quot;settings&quot;:&#123;</span><br><span class="line">		&quot;number_of_sharrds&quot;:5,    //分片数</span><br><span class="line">		&quot;number_of_replicas&quot;1     //备份数据</span><br><span class="line">	&#125;,</span><br><span class="line">	&quot;mappings&quot;:&#123;    //具体的数据结构</span><br><span class="line">		&quot;novel&quot;:&#123;    //类型</span><br><span class="line">			&quot;properties&quot;:&#123;    //文档存储的属性</span><br><span class="line">				&quot;name&quot;:&#123;</span><br><span class="line">					&quot;type&quot;:&quot;text&quot;,</span><br><span class="line">					&quot;analyzer&quot;:&quot;ik_max_word&quot;,    //指定分词器</span><br><span class="line">					&quot;index&quot;:true,    //指定当前属性可以被作为查询的条件</span><br><span class="line">					&quot;store&quot;:false    //是否需要一份额外的存储</span><br><span class="line">				&#125;,</span><br><span class="line">				&quot;author&quot;:&#123;</span><br><span class="line">					&quot;type&quot;:&quot;keyword&quot;</span><br><span class="line">				&#125;,</span><br><span class="line">				&quot;count&quot;:&#123;</span><br><span class="line">					&quot;type&quot;:&quot;long&quot;</span><br><span class="line">				&#125;,</span><br><span class="line">				&quot;on-sale&quot;:&#123;</span><br><span class="line">					&quot;type&quot;:&quot;date&quot;,</span><br><span class="line">					&quot;format&quot;:&quot;yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis&quot;    //时间类型的格式化方式 年月日时分秒，年月日，毫秒数</span><br><span class="line">				&#125;,</span><br><span class="line">				&quot;descr&quot;:&#123;</span><br><span class="line">					&quot;type&quot;:&quot;text&quot;,</span><br><span class="line">					&quot;analyzer&quot;:&quot;ik_max_word&quot;,    //指定分词器</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.4 ES文档的操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">文档在ES服务中的唯一标识，_index，_type，_id三个内容为组合，锁定一个文档，操作时添加还是修改。</span><br><span class="line">添加</span><br><span class="line">1.自动生成id(不推荐)</span><br><span class="line">POST /book/nove1</span><br><span class="line">&#123;</span><br><span class="line">	&quot;name&quot;: &quot;盘龙&quot;</span><br><span class="line">	&quot;author&quot;: &quot;我吃西红柿&quot;</span><br><span class="line">	&quot;count&quot;: &quot;100000&quot;</span><br><span class="line">	&quot;on-sale&quot;: &quot;2021-11-21&quot;</span><br><span class="line">	&quot;descr&quot;: &quot;测试描述&quot;</span><br><span class="line">&#125;</span><br><span class="line">2.手动生成id(手动指定id为1)</span><br><span class="line">PUT /book/nove1/1</span><br><span class="line">&#123;</span><br><span class="line">	&quot;name&quot;: &quot;红楼梦&quot;</span><br><span class="line">	&quot;author&quot;: &quot;曹雪芹&quot;</span><br><span class="line">	&quot;count&quot;: &quot;100000&quot;</span><br><span class="line">	&quot;on-sale&quot;: &quot;2021-11-21&quot;</span><br><span class="line">	&quot;descr&quot;: &quot;测试描述&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">修改</span><br><span class="line">1.覆盖式修改(覆盖原内容，例如时间：如少写参数，则变为0)</span><br><span class="line">POST /book/nove1</span><br><span class="line">&#123;</span><br><span class="line">	&quot;name&quot;: &quot;盘龙&quot;</span><br><span class="line">	&quot;author&quot;: &quot;我吃西红柿&quot;</span><br><span class="line">	&quot;count&quot;: &quot;100000&quot;</span><br><span class="line">	&quot;on-sale&quot;: &quot;2021-11-21&quot;</span><br><span class="line">	&quot;descr&quot;: &quot;测试描述&quot;</span><br><span class="line">&#125;</span><br><span class="line">2.doc修改方式(写哪个修改哪个)</span><br><span class="line">POST /book/nove1/1/_update</span><br><span class="line">&#123;</span><br><span class="line">	&quot;doc&quot;: &#123;</span><br><span class="line">		&quot;name&quot;: &quot;哈哈哈&quot;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.5 ES创建索引(JAVA)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> RestHighLevelClient restHighLevelClient;</span><br><span class="line"></span><br><span class="line">String index = <span class="string">&quot;person&quot;</span>;    <span class="comment">/*ES索引*/</span></span><br><span class="line">      String type = <span class="string">&quot;man&quot;</span>;        <span class="comment">/*类型*/</span></span><br><span class="line">      <span class="comment">//1 构建索引的setting</span></span><br><span class="line">      Settings build = Settings.builder()</span><br><span class="line">              .put(<span class="string">&quot;number_of_shards&quot;</span>, <span class="number">3</span>)     <span class="comment">/*分片数*/</span></span><br><span class="line">              .put(<span class="string">&quot;number_of_replicas&quot;</span>, <span class="number">1</span>)   <span class="comment">/*备份数*/</span></span><br><span class="line">              .build();</span><br><span class="line">      <span class="comment">//2 准备关于索引的mappings</span></span><br><span class="line">      XContentBuilder mappings = JsonXContent.contentBuilder() <span class="comment">// mappings</span></span><br><span class="line">              .startObject()  <span class="comment">//novel</span></span><br><span class="line">                  .startObject(<span class="string">&quot;properties&quot;</span>)  <span class="comment">//properties</span></span><br><span class="line">                      .startObject(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">                          .field(<span class="string">&quot;type&quot;</span>,<span class="string">&quot;text&quot;</span>)</span><br><span class="line">                      .endObject()</span><br><span class="line">                      .startObject(<span class="string">&quot;age&quot;</span>)</span><br><span class="line">                          .field(<span class="string">&quot;type&quot;</span>,<span class="string">&quot;integer&quot;</span>)</span><br><span class="line">                      .endObject()</span><br><span class="line">                      .startObject(<span class="string">&quot;birthday&quot;</span>)</span><br><span class="line">                          .field(<span class="string">&quot;type&quot;</span>,<span class="string">&quot;date&quot;</span>)</span><br><span class="line">                          .field(<span class="string">&quot;formet&quot;</span>,<span class="string">&quot;yyyy-MM-dd&quot;</span>)</span><br><span class="line">                      .endObject()</span><br><span class="line">                  .endObject()</span><br><span class="line">              .endObject();</span><br><span class="line">      <span class="comment">//3 封装Strrings和mappings封装到Request对象中</span></span><br><span class="line">      CreateIndexRequest indexRequest = <span class="keyword">new</span> CreateIndexRequest(index).settings(build).mapping(type, mappings);</span><br><span class="line">      <span class="comment">//4 通过client连接并创建索引</span></span><br><span class="line">      CreateIndexResponse response = restHighLevelClient.indices().create(indexRequest, RequestOptions.DEFAULT);</span><br><span class="line">      <span class="comment">//5 输出查看对象</span></span><br><span class="line">      System.out.println(response);</span><br></pre></td></tr></table></figure>
<p>我看到网上别人还有别的写法，是直接通过client一套操作完成的，这里我也没测试(看到是19年的，可能好多写法都变了，也没细查)<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32403063/article/details/102412457">https://blog.csdn.net/qq_32403063/article/details/102412457</a><br>es中创建创建Index提供了四中方法：①：JSON②：MAP③：bean④：ES自己提供的工具<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/ll1916066410/article/details/80918261">https://blog.csdn.net/ll1916066410/article/details/80918261</a></p>
<hr>
<center>所有的一切，仅仅是因为喜欢。</center>
    </div>

    
</div>
    <div class="footer" id="footer">
    <p>Copyright © 2021 <a class="flink" target="_blank" rel="noopener" href="https://github.com/a16888861">Elliot</a>.
        <label class="el-switch el-switch-green el-switch-sm" style="vertical-align: sub;">
            <input type="checkbox" name="switch" id="update_style">
            <span class="el-switch-style"></span>
        </label>
    </p>
</div>
<input type="hidden" id="web_style" value="black">
<input type="hidden" id="valine_appid" value="CmCti21ooOOIzFOhEyFkFvR0-gzGzoHsz">
<input type="hidden" id="valine_appKey" value="FqiyUqbg7McKN2eG0MCewupf">

<script src="/libs/jquery.min.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>

<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>

<script src="/js/js.js"></script>

<style type="text/css">
.v * {
    color: #698fca;
}

.v .vlist .vcard .vhead .vsys {
    color: #3a3e4a;
}

.v .vlist .vcard .vh .vmeta .vat {
    color: #638fd5;
}

.v .vlist .vcard .vhead .vnick {
    color: #6ba1ff;
}

.v a {
    color: #8696b1;
}

.v .vlist .vcard .vhead .vnick:hover {
    color: #669bfc;
}
</style>
</body>

</html>